/**
 * This file contains fixes for androidx dependency version conflicts
 * that prevent compilation with Android SDK 34
 */

subprojects {
    project.configurations.configureEach { config ->
        if (config.name.contains('implementation') || config.name.contains('Compile') || config.name.contains('Api')) {
            config.resolutionStrategy.eachDependency { details ->
                if (details.requested.group == 'androidx.core' && 
                   (details.requested.name == 'core' || details.requested.name == 'core-ktx')) {
                    if (details.requested.version == '1.15.0') {
                        details.useVersion('1.10.1')
                        details.because("Version 1.15.0 requires compileSdkVersion 35, using 1.10.1 instead")
                    }
                }
            }
        }
    }
}

// Apply a global fix by ensuring all projects use compatible androidx libraries
allprojects {
    configurations.all {
        resolutionStrategy {
            // Force compatible versions
            force 'androidx.core:core-ktx:1.10.1'
            force 'androidx.core:core:1.10.1'
            
            // For any dependency using androidx.core as a transitive dependency
            dependencySubstitution {
                substitute module('androidx.core:core:1.15.0') using module('androidx.core:core:1.10.1')
                substitute module('androidx.core:core-ktx:1.15.0') using module('androidx.core:core-ktx:1.10.1')
            }
        }
    }
}
